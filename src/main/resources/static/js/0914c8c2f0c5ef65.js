(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[153],{89408:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/projects/[projectId]",function(){return n(16612)}])},5892:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var o=n(54581),s=n(13821);function r(){let e=(0,s.bK)();return(0,o.D)(["pod/update"],t=>e.patch("/pod/update",t).then(e=>e.data))}},16612:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return V}});var o=n(35250),s=n(89598),r=n(67093),i=n(89643),a=n(5769),l=n(86099),c=n(82463),d=n(16050),u=n(83549),p=n(86046),x=n.n(p),j=n(72450),h=n.n(j),v=n(48439),m=n(70079),f=n(68974),y=n(80157),g=n(95079),w=n(78152),k=n(53411),b=n(2989),_=n(42343),D=n(92626),z=n(37670),C=n(68845),P=n(36898),I=n(17621),N=n(31337),T=n(14751),E=n(6127),O=n(5892);function S(){let e=(0,I._)(["\n  button:disabled {\n    border-color: var(--chakra-colors-gray-500);\n  }\n"]);return S=function(){return e},e}let Z=(0,N.Z)(i.xu)(S()),F=e=>(0,T.u)(e)?"Open Editor":(0,o.jsxs)(o.Fragment,{children:["Preparing Editor ",(0,o.jsx)(c.$,{ml:"2",size:"sm",color:"gray.500"})]});function H(e){let{projectId:t,projectName:n,...r}=e,{analytics:i}=(0,g.IH)(),{user:l}=(0,s.D3)(),c=(0,O.z)(),{podStatusData:d}=(0,E.x)(),u=(0,m.useCallback)(()=>{window.open("/projects/".concat(t,"/load-vscode"),"_blank")},[t]),{data:p}=(0,P.j)();return(0,o.jsx)(Z,{children:(0,o.jsx)(a.zx,{...r,onClick:e=>{if(e.stopPropagation(),(0,T.u)(d)){var t;let e=new Date;c.mutate({lastLaunched:e.toISOString()}),window.open("".concat(null==d?void 0:null===(t=d.data)||void 0===t?void 0:t.podUrl,"?folder=/home/workspace/projects/").concat(n,"&token=").concat(p),"_blank"),i.track({event:"vscode_opened",properties:{user:l}})}else u()},children:F(d)})})}var M=n(12426),L=n(41891);let W=async e=>{let t=await (0,M.zG)({...e,authOrigin:L.Yt});return t};var J=n(31704),U=n(37059),X=n(34124),A=n(18665),R=n(76090),Y=n(27339),q=n(38227);let B=e=>{var t;let{txId:n,status:a,isTestnet:c}=e,[d,u]=(0,m.useState)(!1),{user:p}=(0,s.D3)(),{analytics:x}=(0,g.IH)();return(0,o.jsx)(r.Td,{onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},"data-testid":"contract-".concat(c?"testnet":"mainnet","-deploy-status"),children:n?(0,o.jsxs)(i.kC,{gap:"2",align:"center",children:[null===(t=q.zI[a])||void 0===t?void 0:t.call(q.zI,c),q.Tm[a],(0,o.jsx)(A.u,{label:"View in Explorer",children:(0,o.jsx)(i.rU,{opacity:d?1:0,display:"flex",href:(0,Y.F)(n,c),target:"_blank",onClick:e=>{x.track({event:"explorer_link_clicked",properties:{user:p}}),e.stopPropagation()},"data-testid":"view-in-explorer-link",children:(0,o.jsx)(l.JO,{as:R.wz_,boxSize:4})})})]}):"—"})};var $=n(81261);let G=()=>{var e,t,n;let p=(0,v.useRouter)(),j=null===(e=p.query)||void 0===e?void 0:e.projectId,{isWalletConnected:w,mainnetAddress:I,testnetAddress:N,authenticate:T}=(0,m.useContext)(k.ZP),{analytics:O}=(0,g.IH)(),{user:S}=(0,s.D3)();(0,U.Z)(j),(0,P.r)();let Z=(0,z.Z)(),F=(0,m.useRef)(null),M=(0,D.Z)(F),{data:L,isLoading:A}=(0,$.PY)(j),R=(0,X.N)(j);(0,m.useEffect)(()=>{O.page({category:"Platform",name:"Project Details",properties:{project:L,user:S}})},[]);let{podStatusData:Y,podStatusError:q}=(0,E.x)(),G=!!(null==Y?void 0:null===(t=Y.data)||void 0===t?void 0:t.isPodUrlReady),K=null==q?void 0:null===(n=q.request)||void 0===n?void 0:n.status,[V,Q]=(0,m.useState)(!1);(0,m.useEffect)(()=>{V||500!==K||Q(!0)},[V,K]);let{data:ee,isFetched:et}=(0,$._0)(j,Y,null==L?void 0:L.name,{onError:e=>{(0,b.H)(e,"Loading contracts from pod",{projectId:j,projectName:null==L?void 0:L.name,error:JSON.stringify(e)})}}),en=null==ee?void 0:ee.data,eo=null==ee?void 0:ee.status,[es,er]=(0,m.useState)(!1);(0,m.useEffect)(()=>{!es&&et&&200===eo&&er(!0)},[es,et]);let ei=(null==en?void 0:en.map(e=>{let{name:t}=e;return t}))||[],{contractsDeployDetails:ea,insertNewDeploy:el}=(0,J.Z)(_.j.Testnet,N,ei),{contractsDeployDetails:ec,insertNewDeploy:ed}=(0,J.Z)(_.j.Mainnet,I,ei),eu=e=>{let{children:t}=e;return(0,o.jsx)(r.Th,{position:"sticky",top:"".concat(M,"px"),shadow:"bottom",bg:"gray.900",zIndex:"2",children:t||null})},ep=(e,t,n)=>{Z({description:"Contract '".concat(e,"' will be deployed to ").concat(t===_.j.Testnet?"testnet":"mainnet","."),status:"success"}),O.track({event:"contract_deployed_success",properties:{contractName:e,network:t,txId:n,user:S}}),t===_.j.Testnet?el(e,n):ed(e,n)},ex=(e,t,n)=>{W({network:e===_.j.Testnet?new u.an:new u._Y,postConditionMode:1,codeBody:n,contractName:t,onFinish:n=>{let o=null==n?void 0:n.txId;if(!n){(0,b.H)(Error("Did not deploy"),"Deploying a contract"),O.track({event:"contract_deployed_failure",properties:{contractName:t,network:e,txId:o,user:S}});return}ep(t,e,o)}})},ej=(null==en?void 0:en.length)>0,eh=!ej&&V,ev=!ej&&!eh&&(!G||!R||!es),em=!ej&&!eh&&!ev,ef=!ej&&!eh&&!ev&&!em;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(x(),{children:[(0,o.jsxs)("title",{children:["Hiro Platform: ",(null==L?void 0:L.name)||"Project"]}),(0,o.jsx)("meta",{name:"description",content:"Manage your smart contracts on the Hiro Platform."})]}),(0,o.jsx)(C.Z,{ref:F,children:(0,o.jsxs)(i.kC,{align:"center",justify:"space-between",gap:"3",children:[(0,o.jsxs)(i.X6,{as:"h2",display:"flex",alignItems:"center",gap:"4",size:"4",children:[(0,o.jsx)(h(),{href:"/projects",passHref:!0,"data-testid":"back-to-projects-list-button",legacyBehavior:!0,children:(0,o.jsx)(a.hU,{size:"sm","aria-label":"Back to projects list",icon:(0,o.jsx)(l.JO,{as:f.And,boxSize:4})})}),A?(0,o.jsx)(c.$,{}):(0,o.jsx)(i.xv,{noOfLines:1,children:(null==L?void 0:L.name)||"Project"})]}),(0,o.jsx)(i.kC,{gap:"2",children:(0,o.jsx)(H,{projectId:j,projectName:null==L?void 0:L.name})})]})}),!ej&&(0,o.jsxs)(i.kC,{direction:"column",gap:"4",width:"80%",maxWidth:"448px",minWidth:"300px",align:"center",mx:"auto",my:"auto",mt:"3",textAlign:"center",children:[(0,o.jsx)(i.xu,{mx:"8",className:ev?"fade-in-out-slow":null,children:(0,o.jsx)("img",{src:"/images/newProject.png",alt:"New Project"})}),(0,o.jsxs)(i.X6,{size:"5",children:[ev&&"Project loading...",em&&"No contracts",ef&&"Something went wrong",eh&&"This is taking awhile!"]}),(0,o.jsxs)(i.xv,{children:[ev&&"Please wait while we set up your workspace and load your contracts.",em&&"Open the editor to add your first contract.",ef&&"Sorry, an unknown error occurred. We're looking into it! Please check back later.",eh&&"Due to an overwhelming response, setting up your workspace is taking longer than expected. Please check back in 15 minutes."]}),(0,o.jsx)(i.kC,{gap:"2",children:em&&(0,o.jsx)(H,{variant:"primary",projectId:j,projectName:null==L?void 0:L.name})})]}),ej&&(0,o.jsx)(r.xJ,{overflowX:"unset",overflowY:"unset",children:(0,o.jsxs)(r.iA,{children:[(0,o.jsx)(r.hr,{children:(0,o.jsxs)(r.Tr,{children:[(0,o.jsx)(eu,{children:"Contract Name"}),(0,o.jsx)(eu,{children:"Last Edited"}),(0,o.jsx)(eu,{children:"Testnet"}),(0,o.jsx)(eu,{children:"Mainnet"}),(0,o.jsx)(eu,{})]})}),(0,o.jsx)(r.p3,{children:en.map(e=>{let{name:t,path:n,lastEdited:s,content:i}=e,c=ec[t],u=ea[t];return(0,o.jsxs)(r.Tr,{"data-testid":"contract-row",children:[(0,o.jsx)(r.Td,{maxWidth:"350px",minWidth:"350px","data-testid":"contract-path",children:n}),(0,o.jsx)(r.Td,{"data-testid":"contract-last-edited-timestamp",children:y.WU(new Date(s))}),(0,o.jsx)(B,{txId:null==u?void 0:u.txId,status:null==u?void 0:u.status,isTestnet:!0}),(0,o.jsx)(B,{txId:null==c?void 0:c.txId,status:null==c?void 0:c.status}),(0,o.jsx)(r.Td,{textAlign:"end",children:(0,o.jsxs)(d.v2,{children:[(0,o.jsx)(d.j2,{as:a.zx,variant:"secondaryLight",size:"sm",fontFamily:"body","data-testid":"contract-deploy-menu-button",children:"Deploy…"}),(0,o.jsx)(d.qy,{fontFamily:"body","data-testid":"contract-deploy-action-menu",children:w?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(d.sN,{as:"button",display:"flex",justifyContent:"space-between",isDisabled:!!(null==u?void 0:u.txId),onClick:()=>{ex(_.j.Testnet,t,i)},children:["Deploy to Testnet",(0,o.jsx)(l.JO,{as:f.lzl,boxSize:4})]}),(0,o.jsx)(d.R,{}),(0,o.jsxs)(d.sN,{as:"button",display:"flex",justifyContent:"space-between",isDisabled:!!(null==c?void 0:c.txId),onClick:()=>{ex(_.j.Mainnet,t,i)},children:["Deploy to Mainnet",(0,o.jsx)(l.JO,{as:f.lzl,boxSize:4})]})]}):(0,o.jsx)(d.sN,{as:"button",onClick:T,children:"Connect Wallet to Deploy"})})]})})]},t)})})]})})]})},K=()=>(0,o.jsx)(w.Z,{children:(0,o.jsx)(G,{})});var V=K}},function(e){e.O(0,[821,112,465,914,128,68,774,888,179],function(){return e(e.s=89408)}),_N_E=e.O()}]);